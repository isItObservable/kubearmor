{"version":16,"variables":[],"tiles":{"0":{"type":"markdown","title":"","content":"**KubeArmor Agents**"},"1":{"type":"data","title":"Number of Tetragon Agents","query":"fetch dt.entity.cloud_application_instance\n| fieldsAdd workload_label=cloudApplicationLabels\n| filter workload_label[`kubearmor-app`] == \"kubearmor\"\n| summarize count()\n","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"count()","prefixIcon":"","recordField":"count()","autoscale":true,"alignment":"center","colorThresholdTarget":"value","trend":{"trendType":"auto","isVisible":false}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{},"displayedFields":[]},"histogram":{"dataMappings":[{"valueAxis":"count()","rangeAxis":""}],"variant":"single","displayedFields":[]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"2":{"type":"data","title":"Cpu health of the ae","query":"timeseries cpu_usages = avg(dt.kubernetes.container.cpu_usage),by:{  k8s.pod.name}\n| fieldsAdd cpu=arrayAvg(cpu_usages)\n| filter startsWith(k8s.pod.name,\"kubearmor-bpf\")\n| fieldsRemove cpu_usages","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"honeycomb","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxisLabel":"k8s.pod.name","valueAxisLabel":"cpu","tooltipVariant":"single","categoryAxis":["k8s.pod.name"],"valueAxis":["cpu"]},"hiddenLegendFields":["k8s.workload","k8s.pod"],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["interval"],"leftAxisDimensions":["k8s.pod.name"]},"valueRepresentation":"absolute"},"singleValue":{"showLabel":true,"label":"k8s.workload.name","prefixIcon":"","recordField":"k8s.workload.name","autoscale":true,"alignment":"center","colorThresholdTarget":"value","trend":{"trendType":"auto","isVisible":false}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"bottom"},"colorMode":"color-palette","colorPalette":"red","dataMappings":{"value":"cpu"},"displayedFields":["k8s.pod.name"]},"histogram":{"dataMappings":[],"variant":"single","displayedFields":[]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"3":{"type":"data","title":"memory health","query":"timeseries cpu_usages = avg(dt.kubernetes.container.memory_working_set), by:{  k8s.pod.name}\n| fieldsAdd memory=arrayAvg(cpu_usages)\n| filter contains(k8s.pod.name,\"kubearmor-bpf\")\n| fieldsRemove cpu_usages","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"honeycomb","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxisLabel":"k8s.pod.name","valueAxisLabel":"memory","tooltipVariant":"single","categoryAxis":["k8s.pod.name"],"valueAxis":["memory"]},"hiddenLegendFields":["k8s.workload","k8s.pod"],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["interval"],"leftAxisDimensions":["k8s.pod.name"]},"valueRepresentation":"absolute"},"singleValue":{"showLabel":true,"label":"k8s.workload.name","prefixIcon":"","recordField":"k8s.workload.name","autoscale":true,"alignment":"center","colorThresholdTarget":"value","trend":{"trendType":"auto","isVisible":false}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"bottom"},"colorMode":"color-palette","colorPalette":"red","dataMappings":{"value":"memory"},"displayedFields":["k8s.pod.name"]},"histogram":{"dataMappings":[],"variant":"single","displayedFields":[]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"4":{"type":"data","title":"Alert /s per policy name","query":"timeseries avg(kubearmor_alerts_with_policy_total, rate: 1s), by: { policyname }\n| limit 20","queryConfig":{"version":"11.3.0","subQueries":[{"id":"A","isEnabled":true,"limit":20,"filter":"","datatype":"metrics","metric":{"key":"kubearmor_alerts_with_policy_total","aggregation":"avg"},"by":["policyname"],"rate":"1s"}]},"subType":"dql-builder-metrics","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"absolute"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":["policyname"],"categoryAxisLabel":"policyname","valueAxis":["interval"],"valueAxisLabel":"interval","tooltipVariant":"single"},"hiddenLegendFields":[],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(kubearmor_alerts_with_policy_total, rate:1s)"],"leftAxisDimensions":["policyname"]},"valueRepresentation":"absolute"},"singleValue":{"showLabel":true,"label":"rule_name","prefixIcon":"","recordField":"rule_name","autoscale":true,"alignment":"center","colorThresholdTarget":"value","trend":{"trendType":"auto","isVisible":false}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"blue","dataMappings":{"value":"interval"},"displayedFields":["policyname"]},"histogram":{"dataMappings":[],"variant":"single","displayedFields":[]},"autoSelectVisualization":false},"davis":{},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"5":{"type":"markdown","title":"","content":"**KubeArmor Events**"},"8":{"type":"data","title":"Event type Per Operations","query":"timeseries avg(kubearmor_alerts_with_operation_total, rate: 1s), by: { operation }","queryConfig":{"version":"11.5.0","subQueries":[{"id":"A","isEnabled":true,"datatype":"metrics","metric":{"key":"kubearmor_alerts_with_operation_total","aggregation":"avg"},"by":["operation"],"rate":"1s"}]},"subType":"dql-builder-metrics","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"vertical","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["operation"],"categoryAxisLabel":"operation","valueAxis":["interval"],"valueAxisLabel":"interval","tooltipVariant":"single"},"colorPalette":"categorical","truncationMode":"middle","hiddenLegendFields":[],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(kubearmor_alerts_with_operation_total, rate:1s)"],"leftAxisDimensions":["operation"]},"valueRepresentation":"absolute"},"singleValue":{"showLabel":true,"label":"type","prefixIcon":"","recordField":"type","autoscale":true,"alignment":"center","colorThresholdTarget":"value","trend":{"trendType":"auto","isVisible":false}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"blue","dataMappings":{"value":"interval"},"displayedFields":["operation"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","displayedFields":[]}},"davis":{},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"10":{"type":"data","title":"Cpu Usage per KuberAmor Pods","query":"timeseries avg(dt.kubernetes.container.cpu_usage), by: { k8s.pod.name }, filter: { matchesValue(k8s.namespace.name, \"kubearmor\") }\n| limit 20","queryConfig":{"version":"11.5.0","subQueries":[{"id":"A","isEnabled":true,"limit":20,"filter":"k8s.namespace.name = kubearmor ","datatype":"metrics","metric":{"key":"dt.kubernetes.container.cpu_usage","aggregation":"avg"},"by":["k8s.pod.name"]}]},"subType":"dql-builder-metrics","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"smooth","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"vertical","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxisLabel":"k8s.pod.name","valueAxisLabel":"interval","tooltipVariant":"single","categoryAxis":["k8s.pod.name"],"valueAxis":["interval"]},"colorPalette":"categorical","truncationMode":"middle","hiddenLegendFields":[],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(dt.kubernetes.container.cpu_usage)"],"leftAxisDimensions":["k8s.pod.name"]},"valueRepresentation":"absolute","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"leftYAxisSettings":{"isLabelVisible":true,"label":"Kubernetes: Container - CPU usage"}},"singleValue":{"showLabel":true,"label":"op","prefixIcon":"","recordField":"op","autoscale":true,"alignment":"center","colorThresholdTarget":"value","trend":{"trendType":"auto","isVisible":false}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"k8s.pod.name"},"displayedFields":["k8s.pod.name"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","displayedFields":[]},"autoSelectVisualization":false},"davis":{},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"13":{"type":"markdown","title":"","content":"**KubeArmor health**"},"14":{"type":"data","title":"Cpu Throttling","query":"timeseries avg(dt.kubernetes.container.cpu_throttled, rate: 1s), by: { k8s.pod.name }, filter: { matchesValue(k8s.namespace.name, \"kubearmor\") }","queryConfig":{"version":"11.3.0","subQueries":[{"id":"A","isEnabled":true,"filter":"k8s.namespace.name = kubearmor ","datatype":"metrics","metric":{"key":"dt.kubernetes.container.cpu_throttled","aggregation":"avg"},"by":["k8s.pod.name"],"rate":"1s"}]},"subType":"dql-builder-metrics","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"vertical","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["k8s.pod.name"],"valueAxis":["interval"],"categoryAxisLabel":"k8s.pod.name","valueAxisLabel":"interval","tooltipVariant":"single"},"colorPalette":"categorical","hiddenLegendFields":[],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(dt.kubernetes.container.cpu_throttled, rate:1s)"],"leftAxisDimensions":["k8s.pod.name"]},"valueRepresentation":"absolute","truncationMode":"middle","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"leftYAxisSettings":{"isLabelVisible":true,"label":"Kubernetes: Container - CPU throttled"}},"singleValue":{"showLabel":true,"label":"k8s.pod.name","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value","trend":{"trendType":"auto","isVisible":false},"recordField":"k8s.pod.name"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"blue","dataMappings":{"value":"interval"},"displayedFields":["k8s.pod.name"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","displayedFields":[]}},"davis":{},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"16":{"type":"data","title":"Memory  usage %","query":"timeseries avg(dt.kubernetes.container.memory_working_set), by: { k8s.pod.name }, filter: { matchesValue(k8s.namespace.name, \"kubearmor\") }\n| limit 20","queryConfig":{"version":"11.5.0","subQueries":[{"id":"A","isEnabled":true,"limit":20,"filter":"k8s.namespace.name = kubearmor ","datatype":"metrics","metric":{"key":"dt.kubernetes.container.memory_working_set","aggregation":"avg"},"by":["k8s.pod.name"]}]},"subType":"dql-builder-metrics","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"smooth","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"vertical","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["k8s.pod.name"],"valueAxis":["interval"],"categoryAxisLabel":"k8s.pod.name","valueAxisLabel":"interval","tooltipVariant":"single"},"colorPalette":"categorical","hiddenLegendFields":[],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(dt.kubernetes.container.memory_working_set)"],"leftAxisDimensions":["k8s.pod.name"]},"valueRepresentation":"absolute","truncationMode":"middle","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"leftYAxisSettings":{"isLabelVisible":true,"label":"Kubernetes: Container - working set memory"}},"singleValue":{"showLabel":true,"label":"k8s.pod.name","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value","trend":{"trendType":"auto","isVisible":false},"recordField":"k8s.pod.name"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"blue","dataMappings":{"value":"interval"},"displayedFields":["k8s.pod.name"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","displayedFields":[]},"autoSelectVisualization":false},"davis":{},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"19":{"type":"data","title":"Event cache entries","query":"timeseries avg(tetragon_event_cache_entries)","queryConfig":{"version":"11.3.0","subQueries":[{"id":"A","isEnabled":true,"datatype":"metrics","metric":{"key":"tetragon_event_cache_entries","aggregation":"avg"}}]},"subType":"dql-builder-metrics","visualization":"areaChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"vertical","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color"},"colorPalette":"categorical","hiddenLegendFields":[],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(tetragon_event_cache_entries)"],"leftAxisDimensions":[]},"valueRepresentation":"absolute"},"singleValue":{"showLabel":true,"prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value","trend":{"trendType":"auto","isVisible":false}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","displayedFields":[]}},"davis":{},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"23":{"type":"data","title":"","query":"fetch logs\n| filter k8s.namespace.name==\"kubearmor\"\n| filter k8s.deployment.name==\"kubearmor-relay\"\n| parse log, \"JSON:log_json\"\n| fieldsAdd nodename=log_json[HostName], podname=log_json[PodName], containername=log_json[ContainerName], process=log_json[ProcessName], action=log_json[Action],source=log_json[Source], operation=log_json[Operation], ressource=log_json[Resource],data=log_json[Data], type=log_json[Type], namespace=log_json[NamespaceName],result=log_json[Result]\n| filter type == \"ContainerLog\"\n| summarize count(), by:{namespace,operation}","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"pieChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["namespace","operation"],"valueAxis":["count()"],"categoryAxisLabel":"namespace,operation","valueAxisLabel":"count()","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle"},"singleValue":{"showLabel":true,"label":"namespace","prefixIcon":"","recordField":"namespace","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":false},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["namespace","operation"],"dataMappings":{"value":"count()"},"colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","displayedFields":[]},"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"24":{"type":"data","title":"Number of events per minute raised","query":"fetch logs\n| filter k8s.namespace.name==\"kubearmor\"\n| filter k8s.deployment.name==\"kubearmor-relay\"\n| parse log, \"JSON:log_json\"\n| fieldsAdd nodename=log_json[HostName], podname=log_json[PodName], containername=log_json[ContainerName], process=log_json[ProcessName], action=log_json[Action],source=log_json[Source], operation=log_json[Operation], ressource=log_json[Resource],data=log_json[Data], type=log_json[Type], namespace=log_json[NamespaceName],result=log_json[Result]\n| filter type == \"ContainerLog\"\n| summarize count(), by:{bin(timestamp, 60s),namespace,operation}","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"barChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"smooth","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["namespace","operation"],"valueAxis":["count()"],"categoryAxisLabel":"namespace,operation","valueAxisLabel":"count()","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","fieldMapping":{"timestamp":"bin(timestamp, 60s)","leftAxisValues":["count()"],"leftAxisDimensions":["namespace"]},"hiddenLegendFields":[]},"singleValue":{"showLabel":true,"label":"namespace","prefixIcon":"","recordField":"namespace","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":false},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["namespace","operation"],"dataMappings":{"value":"count()"},"colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","displayedFields":[]},"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"25":{"type":"data","title":"Type of events raised","query":"fetch logs\n| filter k8s.namespace.name==\"kubearmor\"\n| filter k8s.deployment.name==\"kubearmor-relay\"\n| parse log, \"JSON:log_json\"\n| fieldsAdd nodename=log_json[HostName], podname=log_json[PodName], containername=log_json[ContainerName], process=log_json[ProcessName], action=log_json[Action],source=log_json[Source], operation=log_json[Operation], ressource=log_json[Resource],data=log_json[Data], type=log_json[Type], namespace=log_json[NamespaceName],result=log_json[Result]\n| filter type == \"ContainerLog\"\n| summarize count(), by:{ operation}","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"pieChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["operation"],"categoryAxisLabel":"operation","valueAxis":["count()"],"valueAxisLabel":"count()","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle"},"singleValue":{"showLabel":true,"label":"operation","prefixIcon":"","recordField":"operation","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":false},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["operation"],"dataMappings":{"value":"count()"},"colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","displayedFields":[]},"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"26":{"type":"markdown","title":"","content":"## KubeArmor Alerts ##"},"27":{"type":"data","title":"Number Of Actions Blocked per Namespace","query":"fetch logs\n| filter k8s.namespace.name==\"kubearmor\"\n| filter k8s.deployment.name==\"kubearmor-relay\"\n| parse log, \"JSON:log_json\"\n| fieldsAdd nodename=log_json[HostName], podname=log_json[PodName], containername=log_json[ContainerName], process=log_json[ProcessName], action=log_json[Action],source=log_json[Source], operation=log_json[Operation], ressource=log_json[Resource],data=log_json[Data], type=log_json[Type], namespace=log_json[NamespaceName],result=log_json[Result]\n| filter type != \"ContainerLog\"\n| filter action==\"Block\"\n| fieldsAdd tags=log_json[Tags], policy=log_json[PolicyName], enforcer=log_json[Enforcer], message=log_json[Message]\n| summarize count(), by:{bin(timestamp,30s),namespace}","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["namespace"],"categoryAxisLabel":"namespace","valueAxis":["count()"],"valueAxisLabel":"count()","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","hiddenLegendFields":[],"fieldMapping":{"timestamp":"bin(timestamp, 30s)","leftAxisValues":["count()"],"leftAxisDimensions":["namespace"]}},"singleValue":{"showLabel":true,"label":"bin(timestamp, 30s)","prefixIcon":"","recordField":"bin(timestamp, 30s)","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":false},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["namespace"],"dataMappings":{"value":"count()"},"colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","displayedFields":[]},"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},"layouts":{"0":{"x":0,"y":0,"w":24,"h":1},"1":{"x":0,"y":1,"w":3,"h":6},"2":{"x":3,"y":1,"w":4,"h":6},"3":{"x":7,"y":1,"w":4,"h":6},"4":{"x":0,"y":15,"w":6,"h":8},"5":{"x":0,"y":7,"w":24,"h":1},"8":{"x":6,"y":15,"w":7,"h":8},"10":{"x":0,"y":24,"w":10,"h":7},"13":{"x":0,"y":23,"w":24,"h":1},"14":{"x":0,"y":31,"w":10,"h":6},"16":{"x":10,"y":24,"w":10,"h":7},"19":{"x":16,"y":8,"w":8,"h":6},"23":{"x":11,"y":1,"w":8,"h":6},"24":{"x":0,"y":8,"w":11,"h":6},"25":{"x":11,"y":8,"w":5,"h":6},"26":{"x":0,"y":14,"w":16,"h":1},"27":{"x":13,"y":15,"w":7,"h":8}},"importedWithCode":false,"settings":{}}